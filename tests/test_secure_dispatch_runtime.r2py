"""
<Author> 
  Nick Stephens
<Description>
  This test checks secure_dispatch_runtime and makes sure it is producing
  the expected behavior

Expected Output:
  TBD
"""
dy_import_module_symbols('encasementlib.r2py')

TYPE="type"
ARGS="args"
RETURN="return"
EXCP="exceptions"
TARGET="target"
FUNC="func"
OBJC="objc"
CONST="const"

def check_function():
  log("check_function was successfully called\n")

if callfunc == 'initialize':

  # should throw an exception
  try:
    secure_dispatch_runtime([], {})
  except RepyArgumentError as e:
    log('Expected error: ', str(e), '\n')

  # should evaluate a new test with
  secure_dispatch_runtime(['test_secure_dispatch_runtime_child.r2py'],\
    {"check_function":{TYPE:FUNC, ARGS:None,EXCP:Exception,RETURN:"any",TARGET:check_function},\
     "check_constant":{TYPE:CONST, TARGET:"validateme"}}\
  )
